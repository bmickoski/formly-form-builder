<div class="fb-section">
  <mat-form-field appearance="outline" class="fb-field">
    <mat-label>Search fields</mat-label>
    <input matInput [value]="filter()" (input)="filter.set(($any($event.target).value ?? '').toString())" />
  </mat-form-field>
  <div class="fb-hint">Drag items into the canvas. Canvas shows placeholders only; Preview renders the real form.</div>
</div>

<mat-accordion multi class="fb-section">
  @for (cat of categories(); track cat.category) {
    <mat-expansion-panel [expanded]="true">
      <mat-expansion-panel-header>
        <mat-panel-title>{{ cat.category }}</mat-panel-title>
      </mat-expansion-panel-header>

      <div style="display:grid; gap:10px; padding: 8px 0 12px;">
        <div
          cdkDropList
          [id]="paletteListId(cat.category)"
          [cdkDropListData]="[]"
          [cdkDropListConnectedTo]="connectedDropLists()"
          [cdkDropListSortingDisabled]="true"
        >
          @for (item of cat.items; track item.id) {
            <div class="fb-palette-item" cdkDrag [cdkDragData]="{ kind: 'palette', paletteId: item.id }">
              <div>{{ item.title }}</div>
              <div class="fb-hint">{{ item.category }}</div>
            </div>
          }
        </div>
      </div>
    </mat-expansion-panel>
  }
</mat-accordion>
